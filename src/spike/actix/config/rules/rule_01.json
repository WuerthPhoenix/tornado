{
    "name": "all_emails_and_syslogs",
    "description": "This is All Emails and Syslogs",
    "priority": 42,
    "continue": true,
    "active": true,
    "constraint": {
      "WHERE": {
        "type": "AND",
        "operators": [
          {
            "type": "equal",
            "first": "${event.type}",
            "second": "email"
          },
          {
            "type": "OR",
            "operators": [
              {
                "type": "equal",
                "first": "${event.payload.body}",
                "second": "something"
              },
              {
                "type": "equal",
                "first": "${event.payload.body}",
                "second": "other"
              }
            ]
          }
        ]
      },
      "WITH": {
        "extracted_temp": {
          "from": "${event.payload.body}",
          "regex": {
            "match": "([0-9]+\\sDegrees)",
            "group_match_idx": 2
          }
        }
      }
    },
    "actions": [
      {
        "id": "Log",
        "payload": {
          "type": "${event.payload.hostname}",
          "service": "${event.payload.service}",
          "state": "CRITICAL",
          "comment": "${_variables.extracted_temp}"
        }
    }
    ]
  }
