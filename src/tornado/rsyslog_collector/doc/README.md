# Rsyslog Collector (binary) 

The Rsyslog Collector binary is an executable that generates Tornado Events from
rsyslog inputs.


## How it works

This collector is meant to be integrated with rsyslogâ€™s logging through the 
[omprog module](https://www.rsyslog.com/doc/v8-stable/configuration/modules/omprog.html).
Consequently, it is never started manually, instead, it will be started, and managed,
directly by rsyslog itself.

Example of rsyslog configuration that pipes logs to the rsyslog-collector:
```
module(load="omprog")

action(type="omprog"
       binary="/path/to/rsyslog_collector --some-collector-options")
```

With this configuration, rsyslog is in charge of starting the collector when needed and of
piping incoming logs to it.
Finally, the Tornado Events generated by the collector  
will be forwarded to the Tornado executable UDS socket.

This integration strategy is the best option for supporting high performance 
with massive amounts of log data. 

As the collector expects the input to be in JSON format, rsyslog should be configured
to properly pipe its inputs in this form.


## Configuration

This collector's configuration is based on these command line parameters:
- __logger-stdout__: Determines whether the Logger should print to standard output. 
  Valid values: true, false. False by default.
- __logger-file-path__: A file path in the file system; if provided, the Logger will 
  append any output to it.
- __logger-level__: The Logger level; valid values: _trace_, _debug_, _info_, _warn_, _error_.
  The default value is _warn_.
- __uds-path__: The Unix Socket path where outgoing events will be written. 
  This should be the path where Tornado is listening for incoming events.
  By default it is _/var/run/tornado/tornado.sock_
- __uds_mailbox_capacity__: The Events in-memory buffer size. 
  It makes the application resilient to Tornado crashes or temporary unavailability.
  When Tornado will be working again, all messages in the buffer will be sent. 
  When the buffer is full, the collector will start loosing messages.
  The default buffer value is 10000.


More information about the logger configuration are available 
[here](../../../common/logger/doc/README.md).


An example of a full startup setup is:
```
module(load="omprog")

action(type="omprog"
       binary="/path/to/rsyslog_collector --logger-file-path=/log/rsys-collector.log --logger-level=info --uds-path=/tmp/tornado")
```

In this case the collector:
- logs to the /log/rsys-collector.log file at info level
- writes outcoming Events to the UDS socket at _/tmp/tornado_.   
